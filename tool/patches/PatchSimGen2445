diff -r -u -w Math58b/src/main/java/org/apache/commons/math/optimization/general/LevenbergMarquardtOptimizer.java math_58_buggy/src/main/java/org/apache/commons/math/optimization/general/LevenbergMarquardtOptimizer.java
--- Math58b/src/main/java/org/apache/commons/math/optimization/general/LevenbergMarquardtOptimizer.java	2018-11-13 21:34:18.640609191 +0800
+++ math_58_buggy/src/main/java/org/apache/commons/math/optimization/general/LevenbergMarquardtOptimizer.java	2018-11-13 21:34:31.773090769 +0800
@@ -388,7 +388,7 @@
                         }
                         delta = tmp * FastMath.min(delta, 10.0 * lmNorm);
                         lmPar /= tmp;
-                } else if ((lmPar == 0) || (ratio >= 0.75)) {
+} else if((FastMath.abs(actRed)<=costRelativeTolerance&&preRed<=costRelativeTolerance&&ratio<=2.0)||lmPar<=parRelativeTolerance*lmNorm){
                     delta = 2 * lmNorm;
                     lmPar *= 0.5;
                 }
